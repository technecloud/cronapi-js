(function(){"use strict";this.cronapi={},this.doEval=function(e){return e},this.evalInContext=function(js){return eval("doEval("+js+")")},this.cronapi.conversion={},this.cronapi.conversion.asciiToBinary=function(e){var t="";if(e.length>0)for(var n=0;n<e.length;n++)for(var r=e.charCodeAt(n),o=7;o>=0;o--)t+=r>>o&1;return t},this.cronapi.conversion.toBoolean=function(e){return parseBoolean(e)},this.cronapi.conversion.toBytes=function(e){return e?e.toString():""},this.cronapi.conversion.chrToAscii=function(e){return e?e.charCodeAt(0):null},this.cronapi.conversion.stringToJs=function(e){return stringToJs(e)},this.cronapi.conversion.stringToDate=function(value){var pattern=/^\s*(\d+)[\/\.-](\d+)[\/\.-](\d+)(\s(\d+):(\d+):(\d+))?\s*$/;if(value){if(value instanceof Date)return value;if(pattern.test(value)){var splited=pattern.exec(value),userLang=(navigator.language||navigator.userLanguage).split("-")[0];if("pt"==userLang||"en"==userLang){var functionToCall=eval(userLang+"Date");return functionToCall(splited)}return new Date(value)}return new Date(value)}return null},this.cronapi.conversion.intToHex=function(e){return Number(e).toString(16).toUpperCase()},this.cronapi.conversion.toLong=function(e){return parseInt(e)},this.cronapi.conversion.toString=function(e){return e?new String(e):""},this.cronapi.util={},this.cronapi.util.callServerBlocklyAsync=function(e,t,n){var r="api/cronapi/call/#classNameWithMethod#/".replace("#classNameWithMethod#",e),o=(cronapi.$scope.http,[]);$(arguments).each(function(){o.push(this)});var a="";window.uToken&&(a=window.uToken);$.ajax({type:"POST",url:r,dataType:"html",data:JSON.stringify(o.slice(3)),headers:{"Content-Type":"application/json","X-AUTH-TOKEN":a,toJS:!0},success:t,error:n})},this.cronapi.util.makeCallServerBlocklyAsync=function(blocklyWithFunction,callbackSuccess,callbackError){var paramsApply=[];paramsApply.push(blocklyWithFunction),paramsApply.push(function(data){"string"==typeof callbackSuccess?eval(callbackSuccess)(evalInContext(data)):callbackSuccess&&callbackSuccess(evalInContext(data))}),paramsApply.push(function(data,status,errorThrown){if("string"==typeof callbackError)eval(callbackError)(errorThrown);else if(callbackError)callbackError(errorThrown);else{var message="Unknown error";errorThrown&&(message=errorThrown),cronapi.$scope.Notification.error(message)}}),$(arguments).each(function(e){e>=3&&paramsApply.push(this)}),cronapi.util.callServerBlocklyAsync.apply(this,paramsApply)},this.cronapi.util.callServerBlocklyNoReturn=function(){cronapi.util.callServerBlockly.apply(this,arguments)},this.cronapi.util.throwException=function(e){throw e},this.cronapi.util.createException=function(e){return e},this.cronapi.util.callServerBlockly=function(e){for(var t="api/cronapi/call/#classNameWithMethod#/".replace("#classNameWithMethod#",e),n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var o="";window.uToken&&(o=window.uToken);var a,i=$.ajax({type:"POST",url:t,dataType:"html",data:JSON.stringify(n),async:!1,headers:{"Content-Type":"application/json","X-AUTH-TOKEN":o,toJS:!0}});return 200==i.status?a=i.responseJSON?i.responseJSON:evalInContext(i.responseText):cronapi.$scope.Notification.error(i.statusText),a},this.cronapi.screen={},this.cronapi.screen.fieldFromScreen=function(e){return e},this.cronapi.screen.changeValueOfField=function(e,t){try{cronapi.$scope.__tempValue=t;var n=new Function("cronapi.$scope."+e+" = cronapi.$scope.__tempValue;");cronapi.$scope.safeApply(n.bind(cronapi.$scope))}catch(e){alert(e)}},this.cronapi.screen.getValueOfField=function(field){try{return field&&field.length>0?field.indexOf("vars.")>-1?eval("cronapi.$scope."+field):eval(field):""}catch(e){alert(e)}},this.cronapi.screen.createScopeVariable=function(e,t){cronapi.$scope[e]=t},this.cronapi.screen.datasourceFromScreen=function(e){return e},this.cronapi.screen.startInsertingMode=function(e){window[e].startInserting(),window[e].$apply()},this.cronapi.screen.startEditingMode=function(e){window[e].$apply(new function(){window[e].startEditing()})},this.cronapi.screen.previusRecord=function(e){window[e].$apply(new function(){window[e].previous()})},this.cronapi.screen.nextRecord=function(e){window[e].$apply(new function(){window[e].next()})},this.cronapi.screen.removeRecord=function(e){window[e].$apply(new function(){window[e].remove()})},this.cronapi.screen.changeView=function(e,t){try{var n="?";$(t).each(function(e){for(var t in this)n+="#key#=#value#&".replace("#key#",Url.encode(t)).replace("#value#",Url.encode(this[t]))}),window.location.hash=e+n}catch(e){alert(e)}},this.cronapi.screen.openUrl=function(e,t,n,r){try{var o="_self",a="";t&&"true"==t.toString().toLowerCase()&&(o="_blank"),n&&(a+="width="+n+","),r&&(a+="height="+r+","),window.open(e,o,a)}catch(e){alert(e)}},this.cronapi.screen.hasNextRecord=function(e){return window[e].hasNext()},this.cronapi.screen.quantityRecords=function(e){return window[e].data.length},this.cronapi.screen.post=function(e){return window[e].post()},this.cronapi.screen.filter=function(e,t){window[e].filter("/"+t)},this.cronapi.dateTime={},this.cronapi.dateTime.getSecond=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getSeconds():0},this.cronapi.dateTime.getMinute=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getMinutes():0},this.cronapi.dateTime.getHour=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getHours():0},this.cronapi.dateTime.getYear=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getFullYear():0},this.cronapi.dateTime.getMonth=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getMonth()+1:0},this.cronapi.dateTime.getDay=function(e){var t=cronapi.conversion.stringToDate(e);return t?t.getDate():0},this.cronapi.dateTime.getDaysBetweenDates=function(e,t){var n=cronapi.conversion.stringToDate(e),r=cronapi.conversion.stringToDate(t);return Math.round((n.getTime()-r.getTime())/864e5)},this.cronapi.dateTime.getMonthsBetweenDates=function(e,t){var n=0,r=0,o=cronapi.conversion.stringToDate(e),a=cronapi.conversion.stringToDate(t);return o&&a&&(r=12*(o.getFullYear()-a.getFullYear()),n=o.getMonth()-a.getMonth(),n+=r,a<o&&o.getDate()<a.getDate()?n--:a>o&&o.getDate()>a.getDate()&&n++),n},this.cronapi.dateTime.getYearsBetweenDates=function(e,t){var n=0,r=cronapi.conversion.stringToDate(e),o=cronapi.conversion.stringToDate(t);return r&&o&&(n=r.getFullYear()-o.getFullYear(),o<r&&(r.getDate()<o.getDate()||r.getMonth()<o.getMonth())?n--:o>r&&(r.getDate()>o.getDate()||r.getMonth()>o.getMonth())&&n++),n},this.cronapi.dateTime.incDay=function(e,t){var n=cronapi.conversion.stringToDate(e);return n.setDate(n.getDate()+t),n},this.cronapi.dateTime.incMonth=function(e,t){var n=cronapi.conversion.stringToDate(e);return n.setMonth(n.getMonth()+t),n},this.cronapi.dateTime.incYear=function(e,t){var n=cronapi.conversion.stringToDate(e);return n.setFullYear(n.getFullYear()+t),n},this.cronapi.dateTime.getNow=function(){return new Date},this.cronapi.dateTime.formatDateTime=function(date,format){for(var dateVar=cronapi.conversion.stringToDate(date),dd=dateVar.getDate(),mm=dateVar.getMonth()+1,yyyy=dateVar.getFullYear(),separator="",maskChars="dmy",i=0;i<format.length;i++)if(!maskChars.includes(format.toLowerCase().charAt(i))){separator=format.toLowerCase().charAt(i);var formatLower=replaceAll(format.toLowerCase(),separator,"+separator+");return eval(formatLower)}return""},this.cronapi.dateTime.newDate=function(e,t,n,r,o,a){var i=new Date;return i.setYear(e),i.setMonth(t-1),i.setDate(n),i.setHours(r),i.setMinutes(o),i.setSeconds(a),i},this.cronapi.dateTime.getValueIsNotNumber=function(e){for(var t=0;t<e.length;t++)if(!"0123456789".includes(e.charAt(t)))return e.charAt(t);return""},this.cronapi.xml={},this.cronapi.xml.XMLGetElementValue=function(e){return e.firstChild?e.firstChild.nodeValue:null},this.cronapi.xml.XMLGetChildElement=function(e,t){var n=e.getElementsByTagName(t);if(n.length>0)return n[0]},this.cronapi.xml.XMLGetRoot=function(e){if(e)return doc.documentElement},this.cronapi.xml.XMLGetAttribute=function(e,t){return node.getAttribute(t)},this.cronapi.xml.XMLOpen=function(e){var t=null;return document.implementation&&document.implementation.createDocument?(t=(new DOMParser).parseFromString(e,"application/xml"),fixXMLDocument(t),t):((t=new ActiveXObject("MSXML2.DOMDocument")).loadXML(e),t)},this.cronapi.xml.XMLGetChildrenElement=function(e,t){return t?e.getElementsByTagName(t):e.childNodes},this.cronapi.xml.XMLGetParentElement=function(e){return e.parentNode},this.cronapi.xml.XMLGetElementTagName=function(e){return e.tagName};var ptDate=function(e){var t=e[1],n=e[2],r=e[3],o=e[5],a=e[6],i=e[7];return o?new Date(r,n-1,t,o,a,i):new Date(r,n-1,t,0,0,0)},enDate=function(e){var t=e[1],n=e[2],r=e[3],o=e[5],a=e[6],i=e[7];return o?new Date(r,t-1,n,o,a,i):new Date(r,t-1,n,0,0,0)},parseBoolean=function(e){return!!e&&("boolean"==typeof e?e:"1"==(e=e.toString().toLowerCase().trim())||"true"==e)},removeAccents=function(e){for(withAccents="áàãâäéèêëíìîïóòõôöúùûüçÁÀÃÂÄÉÈÊËÍÌÎÏÓÒÕÖÔÚÙÛÜÇ",withoutAccents="aaaaaeeeeiiiiooooouuuucAAAAAEEEEIIIIOOOOOUUUUC",newValue="",i=0;i<e.length;i++)withAccents.search(e.substr(i,1))>=0?newValue+=withoutAccents.substr(withAccents.search(e.substr(i,1)),1):newValue+=e.substr(i,1);return newValue},arrayRemove=function(e,t){var n=arrayIndexOf(e,t);-1!=n&&e.splice(n,1)},arrayIndexOf=function(e,t){var n=-1;return $(e).each(function(e){t==this&&(n=e)}),n},replaceAll=function(e,t,n){return e.toString().split(t).join(n)},getWindowHeight=function(){$(window).height()},getWindowWidth=function(){$(window).width()},Url={encode:function(e){return escape(this._utf8_encode(e))},decode:function(e){return this._utf8_decode(unescape(e))},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",n=0,r=c1=c2=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return t}},stringToJs=function(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")}}).bind(window)();